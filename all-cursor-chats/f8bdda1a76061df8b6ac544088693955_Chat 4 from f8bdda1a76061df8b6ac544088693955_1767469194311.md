# Chat: Chat 4 from f8bdda1a76061df8b6ac544088693955

**Source:** f8bdda1a76061df8b6ac544088693955/aiService.prompts
**Messages:** 1
**Recovered:** 2026-01-03T19:39:54.311Z

---

## unknown

Complete Stage 2: Fix availability state calculation

ISSUE: Engine doesn't set availability field â†’ UI can't render visual states

TASK:
1. Search codebase for time advancement function (advanceTime, updateState, timeStep)
2. After stress calculation, add availability logic:
   - Calculate workload: count inProgress tasks assigned to person
   - Set availability: 'burned_out' if stress >= 70, 'overloaded' if workload > 2, else 'normal'
3. Update person state to include availability field
4. Verify types in src/state/types.ts
5. Run: npx tsc --noEmit
6. Report files changed and line numbers

Execute autonomously per project rules 1, 2, 3.


---

